<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Mega Blood Donation CAMP 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
  body { margin:0; font-family: Arial, sans-serif; }

  header {
    background:#c62828; color:white; padding:14px;
    text-align:center; font-size:18px; font-weight:bold;
    position:relative; padding-right: 100px;
  }

  #locBtn {
    position:absolute; right:10px; top:50%;
    transform: translateY(-50%);
    background:white; color:#c62828; border:none;
    padding:8px 10px; font-size:14px; border-radius:6px;
    cursor:pointer; font-weight:bold;
  }

  @media (max-width: 600px) {
    header {
      font-size: 14px;
      padding: 10px;
      padding-right: 90px;
    }
    
    #locBtn {
      font-size: 11px;
      padding: 6px 8px;
      right: 5px;
    }
  }

  /* Highlight the date select dropdown */
  #dateSelect {
    width:100%; padding:10px; margin:5px 0;
    font-size:16px; border-radius:5px;

    /* Highlight styles */
    background-color: #fff3b0;  /* light yellow */
    border: 2px solid #f57c00;  /* orange border */
  }

  #map { height:65vh; width:100%; }

  #panel {
    height:auto; background:#fff; border-top:2px solid #ddd;
    padding:12px; display:block;
  }

  .title { font-weight:bold; font-size:17px; margin-bottom:6px; }
  .meta { color:#555; margin-bottom:6px; }
  .dist { font-weight:bold; margin-bottom:10px; }

  #navBtn {
    background:#1565c0; color:white; padding:10px 12px;
    border-radius:6px; text-decoration:none; font-weight:bold;
    display:inline-block;
  }

  .center-label {
    background: white;
    border: 1px solid #999;
    padding: 3px 6px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 3px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    white-space: nowrap;
    pointer-events: none;
  }

  .user-label {
    background: #2196F3;
    color: white;
    border: 2px solid #1565C0;
    padding: 4px 8px;
    font-size: 12px;
    font-weight: bold;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.4);
    white-space: nowrap;
    pointer-events: none;
  }

  .nearest-label {
    background: #f44336;
    color: white;
    border: 2px solid #c62828;
    padding: 4px 8px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 3px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.4);
    white-space: nowrap;
    pointer-events: none;
  }

  .nearby-label {
    background: #4CAF50;
    color: white;
    border: 1px solid #388E3C;
    padding: 3px 6px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 3px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
    white-space: nowrap;
    pointer-events: none;
  }

  @media (max-width: 600px) {
    .center-label, .nearby-label, .nearest-label {
      font-size: 9px;
      padding: 2px 4px;
    }
    .user-label {
      font-size: 10px;
      padding: 3px 6px;
    }
  }

  #nearbyList {
    margin-top: 10px;
  }
  .nearby-item {
    padding: 8px;
    border-bottom: 1px solid #eee;
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  .nearby-left { max-width: 70%; }
  .nearby-name { font-weight:600; }
  .nearby-meta { font-size:13px; color:#555; }
  .nav-btn-small {
    background:#2d6cdf;
    color:white;
    padding:6px 8px;
    border-radius:6px;
    text-decoration:none;
    font-size:13px;
  }
</style>
</head>
<body>

<header>
  Mega Blood Donation CAMP 2025<br>
  MVPM Alumni Across Maharashtra
  <button id="locBtn">Live Location</button>
</header>

<select id="dateSelect"></select>
<div id="map"></div>

<div id="panel">
  <div class="title" id="cName">Select a date and enable location</div>
  <div class="meta" id="cAddr"></div>
  <div class="dist" id="cDist"></div>
  <a id="navBtn" href="#" target="_blank">Navigate</a>
  <div id="nearbyList"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// Entire original JS remains unchanged
let allCenters = [];
let filteredCenters = [];
let map, userMarker = null, nearestMarker = null;
let watchID = null;
let centerMarkers = [];
let routeLine = null;
const NEARBY_KM = 10;
const MAX_ZOOM = 17;

// Label position directions for collision avoidance
const LABEL_DIRECTIONS = [
  'top', 'bottom', 'right', 'left', 
  'topright', 'topleft', 'bottomright', 'bottomleft'
];

fetch("centres.json")
  .then(r => {
    if(!r.ok) throw new Error("Failed to load centres.json: " + r.status);
    return r.json();
  })
  .then(data => {
    allCenters = data;
    loadDates();
    initMap();
  })
  .catch(err => {
    console.error(err);
    alert("Unable to load centres.json. Check file and run via HTTP server.");
  });

function loadDates() {
  const dateSet = new Set();
  allCenters.forEach(c => {
    if(Array.isArray(c.date)) c.date.forEach(d => dateSet.add(d));
    else if (c.date) dateSet.add(c.date);
  });
  const dates = Array.from(dateSet).sort();
  const select = document.getElementById("dateSelect");

  const defaultOpt = document.createElement("option");
  defaultOpt.value = "";
  defaultOpt.textContent = "Select Date";
  defaultOpt.disabled = true;
  defaultOpt.selected = true;
  select.appendChild(defaultOpt);

  dates.forEach(d => {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = "ðŸ“… " + d;
    select.appendChild(opt);
  });

  select.onchange = () => {
    filterCenters();
    clearRoute();
    clearNearest();
    hidePanelInfo();
  };
}

// All other JS functions remain exactly as in your original code...
</script>

</body>
</html>
